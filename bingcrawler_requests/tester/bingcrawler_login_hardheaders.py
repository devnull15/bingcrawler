#!/usr/bin/python

import requests

url = 'https://login.live.com/ppsecure/secure.srf?lc=1033&sf=1&id=292666&ru=https://account.microsoft.com/auth/complete-signin%3fru%3dhttps%253a%252f%252faccount.microsoft.com%252f%253frefd%253daccount.microsoft.com%2526refp%253dhome-about-index&tw=0&fs=0&kv=0&cb=&cbcxt=&wp=MBI_SSL&wa=wsignin1.0&wreply=https://account.microsoft.com/auth/complete-signin%3fru%3dhttps%253a%252f%252faccount.microsoft.com%252f%253frefd%253daccount.microsoft.com%2526refp%253dhome-about-index'

headers = {'User-Agent':'Mozilla/5.0 (X11; Linux x86_64; rv:44.0) Gecko/20100101 Firefox/44.0 Iceweasel/44.0.2', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language':'en-US,en;q=0.5', 'Accept-Encoding':'gzip, deflate, br', 'Referer':'https://login.live.com/ppsecure/secure.srf?lc=1033&sf=1&id=292666&ru=https://account.microsoft.com/auth/complete-signin%3fru%3dhttps%253a%252f%252faccount.microsoft.com%252f%253frefd%253daccount.microsoft.com%2526refp%253dhome-about-index&tw=0&fs=0&kv=0&cb=&cbcxt=&wp=MBI_SSL&wa=wsignin1.0&wreply=https://account.microsoft.com/auth/complete-signin%3fru%3dhttps%253a%252f%252faccount.microsoft.com%252f%253frefd%253daccount.microsoft.com%2526refp%253dhome-about-index'}
#cookies = {'cookies_are':'working !!@#$%^&*(_)_+~`[[]{}||;:?><,.=', 'cookie2':'cookie2'}

cookies = {'MSPShared': '1', 'mkt1': 'en-US', 'DID': '490', 'ANON': 'A=F10D98CB37A1D0F3FE49E171FFFFFFFF&E=124e&W=1', 'wlidperf': 'FR=L&ST=1462319184433', 'amsc': 'cz8h3nEF0DcEHwKYXz88eJiK913p8FkudFXC7kZTPR7bU8wiT+8dK+DSOdLvQ9GDMdjBibzpKN/bQUBhNU9os2L0cF1KVXkXovQE+/9KvItJRdKkoJk9uQfRpz6HPgePn1IdTcj6wH08Enhw2ezF0BeQyG5F5wF7GQBGo5NPMzLmasPlefHo4Jog09o5DWy53/rz7SZx0xKbPZEECXcsYRfRECosARIgxslr1rBlzmfmRfzLDP0TUDZd35+muNMS:1:3c', 'MH': 'MSFT', 'MSPOK': '$uuid-ad2bbe1b-0bdc-4a81-b32a-174a4502e761', 'MSPBack': '0', 'NAP': 'V=1.9&E=11f4&C=Q-Z7UbjVl4bAuTjHpVriXYx8Oayxwc_8J2TXmlbI2YhUuE0I6XaryA&W=1', 'mkt': 'en-US', 'MSPSoftVis': '@:@', 'CkTst': 'G1462319124377', 'IgnoreCAW': '1', 'AVC': 'v=1.22.3.0&t=05/03/2016 23:42:49', 'SDIDC': 'CReLWr43jObKqs!KYtQD5DmhV8*mNhjlhg35jWv4jvlwFFgLgeBuhisL24fFPTFH4wc5ZW7GXdjjYuSIyN4CmSMUyuV7idVaSVd14zJywOSMCOT49GS7AymUKXDjXCwJ0kY9Du8tnZURsssbRS3Fp2Q$', 'MSPRequ': 'lt=1462319124&co=1&id=292666', 'WLOpt': 'act=[1]'}

data = {'FoundMSAs': '', 'PPFT': 'DcAmVaHiG8*6bDNVvUGMGSUGZKz3kimn%21Rc3VPENcmxQmU7y6lkpyc6Szz*HFxIuCnCfK7W3rca2mrVI6zCDu4m018IPt*7JXWLHz1abg4G36JJfeNiDUBn3Wr2nD3bc0CfvOUDJXIxY7vrrTLmFXEPJKUypOkCqOvuCp5QkcZDxaeT7YBxoJs%21vhlUelj2l1k3V7eFSgR9o6HkDtEy0*v0qyWdmSwDpyT%21n4tXAcluXnwXLCvrdezXPMmGTJt21Fj1E86ZR9py0bwaNxvTB310%24', 'LoginOptions': '3', 'i19': '16416', 'PPSX': 'Pass', 'fspost': '0', 'loginfmt': 'tester20152016%40outlook.com', 'NewUser': '1', 'i17': '0', 'i2': '1', 'i13': '0\n', 'i16': '%7B%22navigationStart%22%3A1462319123698%2C%22unloadEventStart%22%3A0%2C%22unloadEventEnd%22%3A0%2C%22redirectStart%22%3A0%2C%22redirectEnd%22%3A0%2C%22fetchStart%22%3A1462319123701%2C%22domainLookupStart%22%3A1462319123701%2C%22domainLookupEnd%22%3A1462319123701%2C%22connectStart%22%3A1462319123701%2C%22connectEnd%22%3A1462319123701%2C%22requestStart%22%3A1462319123760%2C%22responseStart%22%3A1462319123716%2C%22responseEnd%22%3A1462319124256%2C%22domLoading%22%3A1462319124258%2C%22domInteractive%22%3A1462319124356%2C%22domContentLoadedEventStart%22%3A1462319124374%2C%22domContentLoadedEventEnd%22%3A1462319124374%2C%22domComplete%22%3A1462319124375%2C%22loadEventStart%22%3A1462319124375%2C%22loadEventEnd%22%3A0%7D', 'passwd': 'dFke6%24027t*x5X%26Wo7K*pxVvullX30', 'i21': '0', 'login': 'tester20152016%40outlook.com', 'type': '11', 'i22': '0', 'i18': '__DefaultLogin_Strings%7C1%2C__DefaultLogin_Core%7C1%2C'}

print cookies

r = requests.post(url,headers=headers,cookies=cookies,data=data)
print r.status_code
print r.text
print r.headers
print r.cookies

with open('login.live.com.html', 'w') as f:
    f.write(r.text)
